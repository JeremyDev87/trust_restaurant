# Kakao Map API ì—°ë™ ì„¤ê³„

## ê°œìš”

ì‹ë‹¹ ê²€ìƒ‰ ì •í™•ë„ë¥¼ ë†’ì´ê¸° ìœ„í•´ Kakao Map APIë¥¼ ì‹ì•½ì²˜ API ì¡°íšŒ ì „ì— ì—°ë™í•©ë‹ˆë‹¤.

**ë¬¸ì œì :**
- í˜„ì¬: "ì—­ì‚¼ì—­ ê·¼ì²˜ ë…¸ë¸Œëœë“œ" â†’ ì‹ì•½ì²˜ APIê°€ "ì—­ì‚¼ì—­"ì„ ì£¼ì†Œë¡œ ì¸ì‹ ëª»í•¨
- ì‚¬ìš©ì ì…ë ¥(ìì—°ì–´) â‰  ì‹ì•½ì²˜ DBì˜ ì •í™•í•œ ìƒí˜¸ëª…/ì£¼ì†Œ

**í•´ê²°ì±…:**
1. Kakao Map APIë¡œ ë¨¼ì € ì‹ë‹¹ ê²€ìƒ‰
2. ì •í™•í•œ ìƒí˜¸ëª… + ì£¼ì†Œ íšë“
3. ê·¸ ì •ë³´ë¡œ ì‹ì•½ì²˜ API ì¡°íšŒ

## ì•„í‚¤í…ì²˜

```
[ì‚¬ìš©ì ì…ë ¥]
    â†“
"ì—­ì‚¼ì—­ ê·¼ì²˜ ë…¸ë¸Œëœë“œ"
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  1. Kakao Map API ê²€ìƒ‰          â”‚
â”‚  - í‚¤ì›Œë“œ: "ë…¸ë¸Œëœë“œ"            â”‚
â”‚  - ìœ„ì¹˜: "ì—­ì‚¼ì—­" (ì¢Œí‘œ ë³€í™˜)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  2. ê²°ê³¼ ì²˜ë¦¬                   â”‚
â”‚  - 1ê°œ: ìë™ ì„ íƒ               â”‚
â”‚  - ì—¬ëŸ¬ ê°œ: í›„ë³´ ëª©ë¡ ë°˜í™˜       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  3. ì‹ì•½ì²˜ API ì¡°íšŒ             â”‚
â”‚  - ìƒí˜¸ëª…: "ë…¸ë¸Œëœë“œ ì—­ì‚¼ì "     â”‚
â”‚  - ì£¼ì†Œ: "ì„œìš¸ ê°•ë‚¨êµ¬ ì—­ì‚¼ë™..." â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  4. ê²°ê³¼ ë³‘í•©                   â”‚
â”‚  - ì¹´ì¹´ì˜¤ë§µ ì •ë³´ + ìœ„ìƒë“±ê¸‰     â”‚
â”‚  - ë“±ê¸‰ ì—†ìœ¼ë©´ "ë¯¸ë“±ë¡" í‘œì‹œ    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## íŒŒì¼ êµ¬ì¡°

```
src/
â”œâ”€â”€ services/
â”‚   â”œâ”€â”€ kakao-map.service.ts       # ì‹ ê·œ: ì¹´ì¹´ì˜¤ë§µ API í´ë¼ì´ì–¸íŠ¸
â”‚   â”œâ”€â”€ hygiene-grade.service.ts   # ê¸°ì¡´ ìœ ì§€
â”‚   â””â”€â”€ violation.service.ts       # ê¸°ì¡´ ìœ ì§€
â”‚
â”œâ”€â”€ core/
â”‚   â””â”€â”€ restaurant-hygiene.core.ts # ìˆ˜ì •: ì¹´ì¹´ì˜¤ë§µ ì—°ë™ ì¶”ê°€
â”‚
â”œâ”€â”€ types/
â”‚   â””â”€â”€ kakao-map.types.ts         # ì‹ ê·œ: ì¹´ì¹´ì˜¤ë§µ ì‘ë‹µ íƒ€ì…
â”‚
â””â”€â”€ config/
    â””â”€â”€ index.ts                   # ìˆ˜ì •: KAKAO_API_KEY ì¶”ê°€
```

## Kakao Map API ìƒì„¸

**ì‚¬ìš© API:** [ì¹´ì¹´ì˜¤ ë¡œì»¬ í‚¤ì›Œë“œ ê²€ìƒ‰](https://developers.kakao.com/docs/latest/ko/local/dev-guide#search-by-keyword)

```typescript
// ìš”ì²­
GET https://dapi.kakao.com/v2/local/search/keyword.json
Headers: Authorization: KakaoAK {API_KEY}
Params:
  - query: "ë…¸ë¸Œëœë“œ ì—­ì‚¼ì—­"     // ì‹ë‹¹ëª… + ì§€ì—­
  - category_group_code: "FD6"  // ìŒì‹ì  ì¹´í…Œê³ ë¦¬
  - size: 5                      // ìµœëŒ€ 5ê°œ ê²°ê³¼

// ì‘ë‹µ (í•„ìš”í•œ í•„ë“œë§Œ)
{
  "documents": [{
    "place_name": "ë…¸ë¸Œëœë“œë²„ê±° ì—­ì‚¼ì ",
    "address_name": "ì„œìš¸ ê°•ë‚¨êµ¬ ì—­ì‚¼ë™ 123-45",
    "road_address_name": "ì„œìš¸ ê°•ë‚¨êµ¬ í…Œí—¤ë€ë¡œ 123",
    "category_name": "ìŒì‹ì  > íŒ¨ìŠ¤íŠ¸í‘¸ë“œ",
    "phone": "02-1234-5678",
    "x": "127.0365",  // ê²½ë„
    "y": "37.5012"    // ìœ„ë„
  }]
}
```

**ì¹´í…Œê³ ë¦¬ ì½”ë“œ:**
- `FD6`: ìŒì‹ì 
- `CE7`: ì¹´í˜

ë‘ ì¹´í…Œê³ ë¦¬ ëª¨ë‘ ê²€ìƒ‰í•˜ì—¬ ê²°ê³¼ë¥¼ ë³‘í•©í•©ë‹ˆë‹¤.

## ê²€ìƒ‰ íë¦„ ë° ë§¤ì¹­ ë¡œì§

```typescript
// kakao-map.service.ts
async function searchRestaurant(query: string, region: string) {
  // 1. ìŒì‹ì  + ì¹´í˜ ë‘ ì¹´í…Œê³ ë¦¬ë¡œ ê²€ìƒ‰
  const searchQuery = `${query} ${region}`;

  // 2. FD6(ìŒì‹ì ), CE7(ì¹´í˜) ê²°ê³¼ ë³‘í•©
  const results = await Promise.all([
    searchByCategory(searchQuery, 'FD6'),
    searchByCategory(searchQuery, 'CE7'),
  ]);

  // 3. ì¤‘ë³µ ì œê±° í›„ ë°˜í™˜
  return deduplicateByPlaceId(results.flat());
}

// restaurant-hygiene.core.ts (ìˆ˜ì •ëœ íë¦„)
async function queryRestaurantHygiene(params) {
  // Step 1: ì¹´ì¹´ì˜¤ë§µ ê²€ìƒ‰
  const kakaoResults = await kakaoMapService.searchRestaurant(
    params.restaurant_name,
    params.region
  );

  // Step 2: ê²°ê³¼ ì²˜ë¦¬
  if (kakaoResults.length === 0) {
    return { error: 'NOT_FOUND', message: 'ê²€ìƒ‰ ê²°ê³¼ ì—†ìŒ' };
  }

  if (kakaoResults.length > 1) {
    return { error: 'MULTIPLE_RESULTS', candidates: kakaoResults };
  }

  // Step 3: ë‹¨ì¼ ê²°ê³¼ â†’ ì‹ì•½ì²˜ API ì¡°íšŒ
  const place = kakaoResults[0];
  const hygieneResult = await findHygieneByNameAndAddress(
    place.place_name,
    place.address_name
  );

  // Step 4: ê²°ê³¼ ë³‘í•©
  return {
    restaurant: {
      name: place.place_name,
      address: place.road_address_name || place.address_name,
      phone: place.phone,
      category: place.category_name,
    },
    hygiene_grade: hygieneResult ?? { has_grade: false, message: 'ìœ„ìƒë“±ê¸‰ ë¯¸ë“±ë¡' },
    violations: ...
  };
}
```

## ì—ëŸ¬ ì²˜ë¦¬

| ìƒí™© | ì²˜ë¦¬ |
|------|------|
| ì¹´ì¹´ì˜¤ë§µ ê²€ìƒ‰ ê²°ê³¼ ì—†ìŒ | `NOT_FOUND` - "í•´ë‹¹ ì§€ì—­ì—ì„œ ì‹ë‹¹ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤" |
| ì¹´ì¹´ì˜¤ë§µ ê²°ê³¼ ì—¬ëŸ¬ ê°œ | `MULTIPLE_RESULTS` - í›„ë³´ ëª©ë¡ ë°˜í™˜ (ìµœëŒ€ 5ê°œ) |
| ì¹´ì¹´ì˜¤ë§µ API ì˜¤ë¥˜ | `KAKAO_API_ERROR` - API ì˜¤ë¥˜ ë©”ì‹œì§€ |
| ì‹ì•½ì²˜ ìœ„ìƒë“±ê¸‰ ì—†ìŒ | ì •ìƒ ì‘ë‹µ + `hygiene_grade.has_grade: false` |
| ì‹ì•½ì²˜ API ì˜¤ë¥˜ | ì¹´ì¹´ì˜¤ë§µ ì •ë³´ë§Œ ë°˜í™˜ + ìœ„ìƒë“±ê¸‰ ì¡°íšŒ ì‹¤íŒ¨ í‘œì‹œ |

## ì‘ë‹µ í˜•ì‹

```typescript
{
  success: true,
  data: {
    restaurant: {
      name: "ë…¸ë¸Œëœë“œë²„ê±° ì—­ì‚¼ì ",
      address: "ì„œìš¸ ê°•ë‚¨êµ¬ í…Œí—¤ë€ë¡œ 123",
      phone: "02-1234-5678",
      category: "ìŒì‹ì  > íŒ¨ìŠ¤íŠ¸í‘¸ë“œ",
      source: "kakao"  // ë°ì´í„° ì¶œì²˜
    },
    hygiene_grade: {
      has_grade: true,  // ë˜ëŠ” false
      grade: "AA",
      grade_label: "ìš°ìˆ˜",
      grade_date: "2024-01-15",
      valid_until: "2026-01-14",
      stars: 2
    },
    violations: {
      total_count: 0,
      recent_items: [],
      has_more: false
    }
  },
  summary: "ğŸ† ìœ„ìƒë“±ê¸‰: â˜…â˜… ìš°ìˆ˜ (AA)..."
}
```

## êµ¬í˜„ ë‹¨ê³„

| Phase | ì‘ì—… | ì˜ˆìƒ ë³€ê²½ |
|-------|------|----------|
| **1** | ì¹´ì¹´ì˜¤ë§µ ì„œë¹„ìŠ¤ ìƒì„± | `kakao-map.service.ts`, `kakao-map.types.ts` ì‹ ê·œ |
| **2** | ì„¤ì • ì—…ë°ì´íŠ¸ | `config/index.ts`ì— `KAKAO_API_KEY` ì¶”ê°€ |
| **3** | ì½”ì–´ ë¡œì§ ìˆ˜ì • | `restaurant-hygiene.core.ts` íë¦„ ë³€ê²½ |
| **4** | MCP ë„êµ¬ íŒŒë¼ë¯¸í„° ê°œì„  | ìì—°ì–´ ì…ë ¥ ì§€ì› ê°•í™” |
| **5** | í…ŒìŠ¤íŠ¸ ì‘ì„± | ì¹´ì¹´ì˜¤ë§µ ì„œë¹„ìŠ¤ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ |
| **6** | ë¹Œë“œ ë° ë°°í¬ | Vercel í™˜ê²½ë³€ìˆ˜ ì¶”ê°€ |

## í™˜ê²½ë³€ìˆ˜

```bash
# .env
FOOD_API_KEY=your_food_safety_api_key
KAKAO_API_KEY=your_kakao_rest_api_key  # ì‹ ê·œ
```

## ê²°ì • ì‚¬í•­ ìš”ì•½

| í•­ëª© | ê²°ì • |
|------|------|
| ë³µìˆ˜ ê²°ê³¼ ì²˜ë¦¬ | 1ê°œ: ìë™ ì„ íƒ, ì—¬ëŸ¬ ê°œ: ëª©ë¡ ì œì‹œ |
| ìœ„ìƒë“±ê¸‰ ì—†ëŠ” ê²½ìš° | ì¹´ì¹´ì˜¤ë§µ ì •ë³´ + "ìœ„ìƒë“±ê¸‰ ë¯¸ë“±ë¡" í‘œì‹œ |
| ë§¤ì¹­ ê¸°ì¤€ | ì¹´ì¹´ì˜¤ë§µì—ì„œ ì–»ì€ ìƒí˜¸ëª… + ì£¼ì†Œ |
| API í‚¤ ê´€ë¦¬ | í™˜ê²½ë³€ìˆ˜ `KAKAO_API_KEY` |
| ê²€ìƒ‰ ì¹´í…Œê³ ë¦¬ | ìŒì‹ì (FD6) + ì¹´í˜(CE7) |
